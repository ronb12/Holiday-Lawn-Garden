<!doctype html>
<html lang="en">
  <head>
    <title>Holliday Lawn & Garden</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/assets/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Professional landscaping and garden services in your area.">
    <meta name="keywords" content="lawn care, garden services, landscaping, dashboard">
    <meta name="author" content="Holliday Lawn & Garden">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Dashboard - Holliday Lawn & Garden">
    <meta property="og:description" content="Manage your lawn care services and account settings.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hollidaylawngarden.com/dashboard">
    <meta property="og:image" content="https://hollidaylawngarden.com/assets/images/og-image.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Dashboard - Holliday Lawn & Garden">
    <meta name="twitter:description" content="Manage your lawn care services and account settings.">
    <meta name="twitter:image" content="https://hollidaylawngarden.com/assets/images/og-image.jpg">
    <link rel="canonical" href="https://hollidaylawngarden.com/dashboard">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <!-- Common head elements -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#4CAF50" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link rel="manifest" href="assets/js/manifest.json" />

    <!-- Firebase SDK -->
    <script
      src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.min.js"
      defer
     type="module">
    import { AccessibilityEnhancer } from '/assets/js/modules/accessibility.js';
    import {  } from '/assets/js/modules/config.js';
    import {  } from '/assets/js/modules/config.min.js';
    import { initializeDashboard, loadUserData, setupRealtimeListeners, updateDashboardUI, updateServiceRequestUI, removeServiceRequestUI, initializeEventListeners, handleLogout, editProfile } from '/assets/js/modules/customer_dashboard.js';
    import { initializeDashboard, loadUserData, setupRealtimeListeners, updateDashboardUI, updateServiceRequestUI, removeServiceRequestUI, initializeEventListeners, handleLogout, editProfile } from '/assets/js/modules/customer_dashboard.min.js';
    import { initializeDashboard, checkAuth, loadUserData, loadServiceRequests, for, loadUpcomingServices, loadRecentPayments, updateDashboardStats, showNewRequestForm, closeModal, submitServiceRequest, showPaymentForm, syncWithGoogleCalendar, logout, showLoading, hideLoading, showError, showSuccess, initializeChat, sendMessage, handleTyping, editMessage, deleteMessage, markMessagesAsRead, handleChatError, initializeNotifications, getNotificationIcon, formatTimestamp, markNotificationAsRead, markAllAsRead, toggleNotifications, handleFileSelect, removeFile } from '/assets/js/modules/dashboard.js';
    import { initializeDashboard, checkAuth, loadUserData, loadServiceRequests, loadUpcomingServices, loadRecentPayments, updateDashboardStats, showNewRequestForm, closeModal, submitServiceRequest, showPaymentForm, syncWithGoogleCalendar, logout, showLoading, hideLoading, showError, showSuccess, initializeChat, sendMessage, handleTyping, editMessage, deleteMessage, markMessagesAsRead, handleChatError, initializeNotifications, getNotificationIcon, formatTimestamp, markNotificationAsRead, markAllAsRead, toggleNotifications, handleFileSelect, removeFile } from '/assets/js/modules/dashboard.min.js';
    import { handleFileSelect, displayFile, removeFile, uploadFiles, formatFileSize, showNotification } from '/assets/js/modules/document_upload.js';
    import { handleFileSelect, displayFile, removeFile, uploadFiles, formatFileSize, showNotification } from '/assets/js/modules/document_upload.min.js';
    import { showError, handleError, handleFirebaseError, ErrorHandler } from '/assets/js/modules/error_handler.js';
    import { showError, handleError, handleFirebaseError, ErrorHandler } from '/assets/js/modules/error_handler.min.js';
    import { ErrorHandler } from '/assets/js/modules/error_handling.js';
    import { ErrorHandler } from '/assets/js/modules/error_handling.min.js';
    import { app, auth, db, storage, analytics } from '/assets/js/modules/firebase.js';
    import { app, auth, db, analytics, googleProvider } from '/assets/js/modules/firebase_init.js';
    import { FormValidator } from '/assets/js/modules/form_validation.js';
    import { FormValidator } from '/assets/js/modules/form_validation.min.js';
    import { HeadingEnhancer } from '/assets/js/modules/heading_enhancer.js';
    import { ImageLoader } from '/assets/js/modules/image_loader.js';
    import { ImageOptimizer } from '/assets/js/modules/image_optimization.js';
    import { ImageOptimizer } from '/assets/js/modules/image_optimization.min.js';
    import { ImageOptimizer } from '/assets/js/modules/image_optimizer.js';
    import { ImageOptimizer } from '/assets/js/modules/image_optimizer.min.js';
    import {  } from '/assets/js/modules/login.js';
    import {  } from '/assets/js/modules/login.min.js';
    import { initializeUI, setupEventListeners, registerServiceWorker, initializeFirebase, handleFormSubmit, handleNavigation } from '/assets/js/modules/main.js';
    import { initializeUI, setupEventListeners, registerServiceWorker, initializeFirebase, handleFormSubmit, handleNavigation } from '/assets/js/modules/main.min.js';
    import { MetaEnhancer } from '/assets/js/modules/meta_enhancer.js';
    import { Minifier } from '/assets/js/modules/minifier.js';
    import { Minifier } from '/assets/js/modules/minifier.min.js';
    import {  } from '/assets/js/modules/mobile_menu.js';
    import {  } from '/assets/js/modules/mobile_menu.min.js';
    import { ${this.getExports(content) } from '/assets/js/modules/modularizer.js';
    import { ResourceOptimizer } from '/assets/js/modules/resource_optimizer.js';
    import { createTestResultsContainer, addTestResult, testGoogleSignIn, testEmailSignIn, testPasswordReset, testSignOut, runAuthTests, addTestButton } from '/assets/js/modules/test_auth.js';
    import { createTestResultsContainer, addTestResult, testGoogleSignIn, testEmailSignIn, testPasswordReset, testSignOut, runAuthTests, addTestButton } from '/assets/js/modules/test_auth.min.js';
    import { runTests } from '/assets/js/modules/tests.js';
    import { runTests } from '/assets/js/modules/tests.min.js';
    import { ModuleUpdater } from '/assets/js/modules/update_modules.js';
    import { ResourceUpdater } from '/assets/js/modules/update_resources.js';
    import { ResourceUpdater } from '/assets/js/modules/update_resources.min.js';
    import { UXEnhancer, class
        if } from '/assets/js/modules/ux_enhancer.js';</script>
    <script
      src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.min.js"
      defer
     type="module"></script>
    <script
      src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.min.js"
      defer
     type="module"></script>
    <script
      src="https://www.gstatic.com/firebasejs/10.8.0/firebase-storage-compat.min.js"
      defer
     type="module"></script>
    <script
      src="https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics-compat.min.js"
      defer
     type="module"></script>
    <script
      src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-check-compat.min.js"
      defer
     type="module"></script>
    <script
      src="https://www.gstatic.com/firebasejs/10.8.0/firebase-performance-compat.min.js"
      defer
     type="module"></script>

    <!-- Firebase Configuration -->
    <script src="/js/firebase-config.min.js" defer type="module"></script>
    <script src="/js/firebase-init.min.js" defer type="module"></script>

    <!-- Service Worker Registration -->
    <script defer type="module">
      document.addEventListener("DOMContentLoaded", () => {
        if ("serviceWorker" in navigator) {
          navigator.serviceWorker
            .register("/assets/js/service-worker.js")
            .then((registration) => {
              console.log("Service Worker registered:", registration);
            })
            .catch((error) => {
              console.error("Service Worker registration failed:", error);
            });
        }
      });
    </script>
  
        <script type="application/ld+json">
          {
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Customer Dashboard - Holliday Lawn & Garden",
  "description": "Access your Holliday Lawn & Garden customer dashboard. View your services and account information.",
  "url": "https://hollidaylawngarden.com/dashboard",
  "publisher": {
    "@type": "Organization",
    "name": "Holliday Lawn & Garden",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hollidaylawngarden.com/assets/images/hollidays-logo.png"
    }
  }
}
        </script>
      
</head>
  <body>
    <div id="loading-overlay" class="loading-overlay" style="display: none">
      <div class="spinner"></div>
      <p id="loading-message">Loading...</p>
    </div>
    <div id="notification-container" class="notification-container">
      <div id="notification" class="notification" style="display: none;">
        <span class="notification-message"></span>
        <button class="notification-close button-with-loading button-with-loading" aria-label="Button">&times;</button>
      </div>
    </div>
    <div id="loading-spinner" class="loading-spinner" style="display: none;">
      <div class="spinner"></div>
    </div>
    <header class="main-header">
      <div class="logo">
        <a href="index.html">
          <picture>
            <source srcset="assets/images/hollidays-logo.optimized-1280.webp" type="image/webp">
            <img src="assets/images/hollidays-logo.optimized-1280.png" alt="Holliday's Lawn & Garden Logo" loading="lazy">
          </picture>
        </a>
      </div>
      <button class="hamburger" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <nav>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="services.html">Services</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="pay-your-bill.html">Pay Your Bill</a></li>
          <li><a href="education.html">Education</a></li>
          <li class="auth-not-required"><a href="login.html">Login</a></li>
          <li class="auth-required" style="display: none;"><a href="customer-dashboard.html">Dashboard</a></li>
          <li id="adminLink" style="display: none;"><a href="admin-login.html">Admin</a></li>
        </ul>
      </nav>
    </header>

    <div class="container">
      <h1 id="greeting">Hello, Customer!</h2>
      <p>
        Thank you for choosing Holiday Lawn & Garden. Your service requests are
        shown below.
      </p>

      <h2>Your Service Requests</h3>
      <table id="requestsTable">
        <thead>
          <tr>
            <th>Service</th>
            <th>Preferred Date</th>
            <th>Notes</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td colspan="5">Loading...</td>
          </tr>
        </tbody>
      </table>

      <h2>Submit New Request</h2>
      <form onsubmit="submitRequest(event)" aria-label="form form" class="form-with-loading form-with-loading form-with-loading">
        <label>Service Type:</label>
        <select id="serviceType">
          <option value="">Select...</option>
          <option value="Lawn Mowing">Lawn Mowing</option>
          <option value="Hedge Trimming">Hedge Trimming</option>
          <option value="Leaf Cleanup">Leaf Cleanup</option></select
        ><br /><br />
        <label>Preferred Date:</label>
        <input type="date" id="preferredDate" required / aria-label="preferredDate date"><br /><br />
        <label>Notes:</label>
        <textarea
          id="requestNotes"
          placeholder="Any special instructions..."
         aria-label="Any special instructions..."></textarea
        ><br />
        <button type="submit" aria-label="Button" class="button-with-loading button-with-loading button-with-loading button-with-loading">Send Request</button>
      </form>

      <br />
      <button onclick="logout()" aria-label="Button" class="button-with-loading button-with-loading">Logout</button>
    </div>

    <footer class="footer" role="contentinfo" aria-label="Site footer">
      <div class="footer-content">
        <div class="footer-main">
          <div class="footer-section">
            <h3>Contact Us</h3>
            <div class="footer-contact">
              <span class="footer-owner">Karl Holliday</span>
              <a href="tel:+15047171887" aria-label="Call us">
                <i class="fas fa-phone" aria-hidden="true"></i>
                <span>(504) 717-1887</span>
              </a>
              <a href="mailto:7holliday@gmail.com" aria-label="Email us">
                <i class="fas fa-envelope" aria-hidden="true"></i>
                <span>7holliday@gmail.com</span>
              </a>
            </div>
          </div>
          <div class="footer-section">
            <h3>Quick Links</h3>
            <ul>
              <li><a href="about.html">About Us</a></li>
              <li><a href="services.html">Services</a></li>
              <li><a href="education.html">Education</a></li>
              <li><a href="contact.html">Contact</a></li>
            </ul>
          </div>
          <div class="footer-section">
            <h3>Customer Portal</h3>
            <ul>
              <li><a href="login.html">Login</a></li>
              <li><a href="register.html">Register</a></li>
              <li><a href="pay-your-bill.html">Pay Your Bill</a></li>
              <li><a href="customer-dashboard.html">Dashboard</a></li>
            </ul>
          </div>
          <div class="footer-section">
            <h3>Legal</h3>
            <ul>
              <li><a href="privacy.html">Privacy Policy</a></li>
              <li><a href="terms.html">Terms of Service</a></li>
            </ul>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; <span id="current-year"></span> Holliday's Lawn & Garden. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <script defer type="module">
      const db = firebase.firestore();
      let currentUser;

      firebase.auth().onAuthStateChanged((user) => {
        if (user) {
          currentUser = user;
          document.getElementById("greeting").innerText =
            `Hello, ${user.email}!`;
          loadRequests();
        } else {
          window.location.href = "login.html";
        }
      });

      function loadRequests() {
        const tbody = document.querySelector("#requestsTable tbody");
        tbody.innerHTML = "<tr><td colspan='5'>Loading...</td></tr>";
        db.collection("service_requests")
          .where("customerEmail", "==", currentUser.email)
          .orderBy("submittedAt", "desc")
          .get()
          .then((snapshot) => {
            tbody.innerHTML = "";
            if (snapshot.empty) {
              tbody.innerHTML =
                "<tr><td colspan='5'>No requests found.</td></tr>";
              return;
            }
            snapshot.forEach((doc) => {
              const r = doc.data();
              tbody.innerHTML += `
          <tr>
            <td>${r.serviceType}</td>
            <td>${r.preferredDate ? new Date(r.preferredDate).toLocaleDateString() : "N/A"}</td>
            <td>${r.notes || "-"}</td>
            <td class="status-${(r.status || "pending").toLowerCase()}">${r.status || "Pending"}</td>
            <td><button onclick="deleteRequest('${doc.id}')" aria-label="Button" class="button-with-loading button-with-loading">Delete</button></td>
          </tr>
        `;
            });
          })
          .catch((err) => {
            console.error("Error loading requests:", err);
            tbody.innerHTML =
              "<tr><td colspan='5'>Failed to load requests.</td></tr>";
          });
      }

      function submitRequest(e) {
        e.preventDefault();
        const type = document.getElementById("serviceType").value;
        const date = document.getElementById("preferredDate").value;
        const notes = document.getElementById("requestNotes").value;

        if (!type || !date)
          return alert("Please select a service type and preferred date.");

        db.collection("service_requests")
          .add({
            fullName: currentUser.displayName || "Customer",
            customerEmail: currentUser.email,
            serviceType: type,
            preferredDate: date,
            notes: notes,
            status: "Pending",
            submittedAt: firebase.firestore.FieldValue.serverTimestamp(),
          })
          .then(() => {
            alert("✅ Request submitted");
            document.querySelector("form").reset();
            loadRequests();
          });
      }

      function deleteRequest(id) {
        if (confirm("Delete this request?")) {
          db.collection("service_requests").doc(id).delete().then(loadRequests);
        }
      }

      function logout() {
        firebase
          .auth()
          .signOut()
          .then(() => (window.location.href = "login.html"));
      }
    </script>
  </body>
</html>
