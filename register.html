<!doctype html>
<html lang="en">
  <head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="assets/images/favicon/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="assets/images/favicon/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="manifest.json">
    <link rel="mask-icon" href="/assets/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Professional landscaping and garden services in your area.">
    <meta name="keywords" content="lawn care, garden services, landscaping, register">
    <meta name="author" content="Holliday Lawn & Garden">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Register - Holliday Lawn & Garden">
    <meta property="og:description" content="Create your Holliday Lawn & Garden account to access our services.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hollidaylawngarden.com/register">
    <meta property="og:image" content="https://hollidaylawngarden.com/assets/images/og-image.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Register - Holliday Lawn & Garden">
    <meta name="twitter:description" content="Create your Holliday Lawn & Garden account to access our services.">
    <meta name="twitter:image" content="https://hollidaylawngarden.com/assets/images/og-image.jpg">
    <link rel="canonical" href="https://hollidaylawngarden.com/register">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Holliday Lawn & Garden</title>

    <!-- Meta Tags -->
    <meta
      name="description"
      content="Create your Holliday's Lawn & Garden account"
    />
    <meta name="theme-color" content="#2e7d32" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta
      name="apple-mobile-web-app-title"
      content="Holliday's Lawn & Garden"
    />
    <meta name="format-detection" content="telephone=no" />
    <meta name="robots" content="index, follow" />

    <!-- Open Graph Tags -->
    <meta
      property="og:title"
      content="Create Account - Holliday's Lawn & Garden"
    />
    <meta
      property="og:description"
      content="Create your Holliday's Lawn & Garden account"
    />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://holiday-lawn-and-garden.web.app/register.html"
    />
    <meta
      property="og:image"
      content="/assets/icons/icon-512.png"
    />

    <!-- Twitter Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="Create Account - Holliday's Lawn & Garden"
    />
    <meta
      name="twitter:description"
      content="Create your Holliday's Lawn & Garden account"
    />
    <meta
      name="twitter:image"
      content="/assets/icons/icon-512.png"
    />

    <!-- Favicon -->
    <link rel="icon" href="assets/icons/favicon.png" type="image/png" />
    <link rel="apple-touch-icon" href="assets/icons/apple-touch-icon.png" />
    <link rel="manifest" href="manifest.json" />

    <!-- Stylesheets -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/styles/variables.css?v=1.0.4" />
    
    <link rel="stylesheet" href="assets/styles/components/mobile-menu.css?v=1.0.3" />
    <link rel="stylesheet" href="assets/styles/components/main.css?v=1.0.4" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />

    <!-- Content Security Policy -->
    <meta
      http-equiv="Content-Security-Policy"
      content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.gstatic.com https://js.stripe.com https://www.googletagmanager.com;
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com;
        font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com https://use.fontawesome.com data:;
        img-src 'self' data: https:;
        connect-src 'self' https://*.googleapis.com https://*.firebaseio.com https://*.firebase.googleapis.com https://*.stripe.com https://www.google-analytics.com;
        frame-src 'self' https://js.stripe.com;
        object-src 'none';
        base-uri 'self';
        form-action 'self';
        upgrade-insecure-requests;
    "
    />

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.min.js" defer type="module">
    import { AccessibilityEnhancer } from '/assets/js/modules/accessibility.js';
    import {  } from '/assets/js/modules/config.js';
    import {  } from '/assets/js/modules/config.min.js';
    import { initializeDashboard, loadUserData, setupRealtimeListeners, updateDashboardUI, updateServiceRequestUI, removeServiceRequestUI, initializeEventListeners, handleLogout, editProfile } from '/assets/js/modules/customer_dashboard.js';
    import { initializeDashboard, loadUserData, setupRealtimeListeners, updateDashboardUI, updateServiceRequestUI, removeServiceRequestUI, initializeEventListeners, handleLogout, editProfile } from '/assets/js/modules/customer_dashboard.min.js';
    import { initializeDashboard, checkAuth, loadUserData, loadServiceRequests, for, loadUpcomingServices, loadRecentPayments, updateDashboardStats, showNewRequestForm, closeModal, submitServiceRequest, showPaymentForm, syncWithGoogleCalendar, logout, showLoading, hideLoading, showError, showSuccess, initializeChat, sendMessage, handleTyping, editMessage, deleteMessage, markMessagesAsRead, handleChatError, initializeNotifications, getNotificationIcon, formatTimestamp, markNotificationAsRead, markAllAsRead, toggleNotifications, handleFileSelect, removeFile } from '/assets/js/modules/dashboard.js';
    import { initializeDashboard, checkAuth, loadUserData, loadServiceRequests, loadUpcomingServices, loadRecentPayments, updateDashboardStats, showNewRequestForm, closeModal, submitServiceRequest, showPaymentForm, syncWithGoogleCalendar, logout, showLoading, hideLoading, showError, showSuccess, initializeChat, sendMessage, handleTyping, editMessage, deleteMessage, markMessagesAsRead, handleChatError, initializeNotifications, getNotificationIcon, formatTimestamp, markNotificationAsRead, markAllAsRead, toggleNotifications, handleFileSelect, removeFile } from '/assets/js/modules/dashboard.min.js';
    import { handleFileSelect, displayFile, removeFile, uploadFiles, formatFileSize, showNotification } from '/assets/js/modules/document_upload.js';
    import { handleFileSelect, displayFile, removeFile, uploadFiles, formatFileSize, showNotification } from '/assets/js/modules/document_upload.min.js';
    import { showError, handleError, handleFirebaseError, ErrorHandler } from '/assets/js/modules/error_handler.js';
    import { showError, handleError, handleFirebaseError, ErrorHandler } from '/assets/js/modules/error_handler.min.js';
    import { ErrorHandler } from '/assets/js/modules/error_handling.js';
    import { ErrorHandler } from '/assets/js/modules/error_handling.min.js';
    import { app, auth, db, storage, analytics } from '/assets/js/modules/firebase.js';
    import { app, auth, db, analytics, googleProvider } from '/assets/js/modules/firebase_init.js';
    import { FormValidator } from '/assets/js/modules/form_validation.js';
    import { FormValidator } from '/assets/js/modules/form_validation.min.js';
    import { HeadingEnhancer } from '/assets/js/modules/heading_enhancer.js';
    import { ImageLoader } from '/assets/js/modules/image_loader.js';
    import { ImageOptimizer } from '/assets/js/modules/image_optimization.js';
    import { ImageOptimizer } from '/assets/js/modules/image_optimization.min.js';
    import { ImageOptimizer } from '/assets/js/modules/image_optimizer.js';
    import { ImageOptimizer } from '/assets/js/modules/image_optimizer.min.js';
    import {  } from '/assets/js/modules/login.js';
    import {  } from '/assets/js/modules/login.min.js';
    import { initializeUI, setupEventListeners, registerServiceWorker, initializeFirebase, handleFormSubmit, handleNavigation } from '/assets/js/modules/main.js';
    import { initializeUI, setupEventListeners, registerServiceWorker, initializeFirebase, handleFormSubmit, handleNavigation } from '/assets/js/modules/main.min.js';
    import { MetaEnhancer } from '/assets/js/modules/meta_enhancer.js';
    import { Minifier } from '/assets/js/modules/minifier.js';
    import { Minifier } from '/assets/js/modules/minifier.min.js';
    import {  } from '/assets/js/modules/mobile_menu.js';
    import {  } from '/assets/js/modules/mobile_menu.min.js';
    import { ${this.getExports(content) } from '/assets/js/modules/modularizer.js';
    import { ResourceOptimizer } from '/assets/js/modules/resource_optimizer.js';
    import { createTestResultsContainer, addTestResult, testGoogleSignIn, testEmailSignIn, testPasswordReset, testSignOut, runAuthTests, addTestButton } from '/assets/js/modules/test_auth.js';
    import { createTestResultsContainer, addTestResult, testGoogleSignIn, testEmailSignIn, testPasswordReset, testSignOut, runAuthTests, addTestButton } from '/assets/js/modules/test_auth.min.js';
    import { runTests } from '/assets/js/modules/tests.js';
    import { runTests } from '/assets/js/modules/tests.min.js';
    import { ModuleUpdater } from '/assets/js/modules/update_modules.js';
    import { ResourceUpdater } from '/assets/js/modules/update_resources.js';
    import { ResourceUpdater } from '/assets/js/modules/update_resources.min.js';
    import { UXEnhancer, class
        if } from '/assets/js/modules/ux_enhancer.js';</script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.min.js" defer type="module"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.min.js" defer type="module"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-storage-compat.min.js" defer type="module"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics-compat.min.js" defer type="module"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-check-compat.min.js" defer type="module"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-performance-compat.min.js" defer type="module"></script>

    <!-- Firebase Configuration -->
    <script type="module" src="assets/js/firebase-config.min.js" defer></script>
    <script type="module" src="assets/js/firebase-init.min.js" defer></script>
    <script type="module" src="assets/js/main.min.js" defer></script>
  
        <script type="application/ld+json">
          {
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Register - Create Your Holliday Lawn & Garden Account",
  "description": "Create your Holliday Lawn & Garden customer account. Get started with our services.",
  "url": "https://hollidaylawngarden.com/register",
  "publisher": {
    "@type": "Organization",
    "name": "Holliday Lawn & Garden",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hollidaylawngarden.com/assets/images/hollidays-logo.png"
    }
  }
}
        </script>
      
</head>
  <body style="background: var(--color-primary-light); color: var(--color-text);">
    <!-- Skip to Main Content -->
    <a href="#main-content" class="skip-to-main" aria-label="Link">Skip to main content</a>

    <!-- Header -->
    <header class="main-header">
      <a href="index.html" class="logo link-with-loading link-with-loading" aria-label="Link">
        
          <picture>
            <source srcset="assets/images/hollidays-logo.webp" type="image/webp">
            <img src="assets/images/hollidays-logo.webp" alt="Holliday's Lawn & Garden Logo" loading="lazy">
          </picture>
      </a>
      <nav aria-label="Main navigation">
        <ul class="nav-links">
          <li><a href="index.html" aria-label="Link" class="link-with-loading link-with-loading">Home</a></li>
          <li><a href="about.html" aria-label="Link" class="link-with-loading link-with-loading">About</a></li>
          <li><a href="services.html" aria-label="Link" class="link-with-loading link-with-loading">Services</a></li>
          <li><a href="contact.html" aria-label="Link" class="link-with-loading link-with-loading">Contact</a></li>
          <li><a href="pay-your-bill.html" aria-label="Link" class="link-with-loading link-with-loading">Pay Your Bill</a></li>
          <li><a href="education.html" aria-label="Link" class="link-with-loading link-with-loading">Education</a></li>
          <li class="auth-not-required"><a href="login.html" aria-label="Link" class="link-with-loading link-with-loading">Login</a></li>
          <li class="auth-required" style="display: none;"><a href="customer-dashboard.html" aria-label="Link" class="link-with-loading link-with-loading">Dashboard</a></li>
          <li id="adminLink" style="display: none;"><a href="admin-login.html" aria-label="Link" class="link-with-loading link-with-loading">Admin</a></li>
        </ul>
      </nav>
      <button class="hamburger button-with-loading button-with-loading" aria-label="Toggle Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="register-section" style="background: var(--color-primary-light); padding: 2rem; border-radius: var(--border-radius); max-width: 500px; margin: 3rem auto;">
      <h1 style="color: var(--color-primary-dark);">Register</h1>
      <p class="description">
        Join Holliday's Lawn & Garden to manage your services and payments.
      </p>

      <div id="error-container" class="error-container"></div>

      <!-- Registration Form -->
      <form id="register-form" class="register-form form-with-loading form-with-loading form-with-loading" novalidate aria-label="register-form form">
        <div class="form-group">
          <label for="firstName">First Name</label>
          <input
            type="text"
            id="firstName"
            name="firstName"
            required
            placeholder="Enter your first name"
            autocomplete="given-name"
            style="border: 1px solid var(--color-primary); border-radius: var(--border-radius); padding: 0.5rem;"
          / aria-label="firstName text">
        </div>

        <div class="form-group">
          <label for="lastName">Last Name</label>
          <input
            type="text"
            id="lastName"
            name="lastName"
            required
            placeholder="Enter your last name"
            autocomplete="family-name"
            style="border: 1px solid var(--color-primary); border-radius: var(--border-radius); padding: 0.5rem;"
          / aria-label="lastName text">
        </div>

        <div class="form-group">
          <label for="email">Email Address</label>
          <input
            type="email"
            id="email"
            name="email"
            required
            placeholder="Enter your email"
            autocomplete="email"
            style="border: 1px solid var(--color-primary); border-radius: var(--border-radius); padding: 0.5rem;"
          / aria-label="email email">
        </div>

        <div class="form-group">
          <label for="phone">Phone Number</label>
          <input
            type="tel"
            id="phone"
            name="phone"
            required
            placeholder="Enter your phone number"
            autocomplete="tel"
            style="border: 1px solid var(--color-primary); border-radius: var(--border-radius); padding: 0.5rem;"
          / aria-label="phone tel">
        </div>

        <div class="form-group">
          <label for="password">Password</label>
          <div class="password-input">
            <input
              type="password"
              id="password"
              name="password"
              required
              placeholder="Create a password"
              autocomplete="new-password"
              style="border: 1px solid var(--color-primary); border-radius: var(--border-radius); padding: 0.5rem;"
            / aria-label="password password">
            <button
              type="button"
              class="toggle-password button-with-loading button-with-loading"
              onclick="togglePassword('password')"
             aria-label="Button">
              <i class="fas fa-eye"></i>
            </button>
          </div>
          <div class="password-strength" id="password-strength"></div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirm Password</label>
          <div class="password-input">
            <input
              type="password"
              id="confirmPassword"
              name="confirmPassword"
              required
              placeholder="Confirm your password"
              autocomplete="new-password"
              style="border: 1px solid var(--color-primary); border-radius: var(--border-radius); padding: 0.5rem;"
            / aria-label="confirmPassword password">
            <button
              type="button"
              class="toggle-password button-with-loading button-with-loading"
              onclick="togglePassword('confirmPassword')"
             aria-label="Button">
              <i class="fas fa-eye"></i>
            </button>
          </div>
        </div>

        <div class="form-group">
          <label class="checkbox-container">
            <input type="checkbox" id="terms" name="terms" required / aria-label="terms checkbox">
            <span class="checkmark"></span>
            I agree to the
            <a href="terms.html" target="_blank" aria-label="Link" class="link-with-loading link-with-loading">Terms of Service</a> and
            <a href="privacy.html" target="_blank" aria-label="Link" class="link-with-loading link-with-loading">Privacy Policy</a>
          </label>
        </div>

        <button type="submit" class="cta-button button-with-loading button-with-loading button-with-loading button-with-loading" id="registerButton" style="background: var(--color-primary); color: var(--color-text-light); border: none; border-radius: var(--border-radius); padding: 0.75rem 2rem; font-weight: 600; margin-top: 1rem;" aria-label="Button">
          <i class="fas fa-user-plus"></i> Create Account
        </button>
      </form>

      <!-- Back to Login -->
      <div class="back-to-login">
        <p>
          Already have an account?
          <a href="login.html" onclick="handleBackToLogin(event)"
             aria-label="Link" class="link-with-loading link-with-loading">Log in here</a
          >
        </p>
      </div>
    </main>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay" style="display: none">
      <div class="spinner"></div>
      <p id="loading-message">Creating your account...</p>
    </div>

    <!-- Footer -->
    <footer class="footer" role="contentinfo" aria-label="Site footer">
      <div class="footer-content">
        <div class="footer-main">
          <div class="footer-section">
            <h3>Contact Us</h3>
            <div class="footer-contact">
              <span class="footer-owner">Karl Holliday</span>
              <a href="tel:+15047171887" aria-label="Call us">
                <i class="fas fa-phone" aria-hidden="true"></i>
                <span>(504) 717-1887</span>
              </a>
              <a href="mailto:7holliday@gmail.com" aria-label="Email us">
                <i class="fas fa-envelope" aria-hidden="true"></i>
                <span>7holliday@gmail.com</span>
              </a>
            </div>
          </div>

          <div class="footer-section">
            <h3>Quick Links</h3>
            <ul>
              <li><a href="about.html">About Us</a></li>
              <li><a href="services.html">Services</a></li>
              <li><a href="education.html">Education</a></li>
              <li><a href="contact.html">Contact</a></li>
            </ul>
          </div>

          <div class="footer-section">
            <h3>Customer Portal</h3>
            <ul>
              <li><a href="login.html">Login</a></li>
              <li><a href="register.html">Register</a></li>
              <li><a href="pay-your-bill.html">Pay Your Bill</a></li>
              <li><a href="customer-dashboard.html">Dashboard</a></li>
            </ul>
          </div>

          <div class="footer-section">
            <h3>Legal</h3>
            <ul>
              <li><a href="privacy.html">Privacy Policy</a></li>
              <li><a href="terms.html">Terms of Service</a></li>
            </ul>
          </div>
        </div>

        <div class="footer-copyright">
          <p>&copy; <span id="current-year"></span> Holliday Lawn & Garden. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <!-- Service Worker Registration -->
    <script defer type="module">
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("/assets/js/service-worker.js")
            .then((registration) => {
              console.log("Service Worker registered:", registration);
            })
            .catch((error) => {
              console.error("Service Worker registration failed:", error);
            });
        });
      }
    </script>

    <!-- Registration Handler -->
    <script defer type="module">
      // Handle Back to Login
      function handleBackToLogin(event) {
        event.preventDefault();
        window.location.href = "/login.html";
      }

      // Toggle Password Visibility
      function togglePassword(inputId) {
        const input = document.getElementById(inputId);
        const icon = input.nextElementSibling.querySelector("i");

        if (input.type === "password") {
          input.type = "text";
          icon.classList.remove("fa-eye");
          icon.classList.add("fa-eye-slash");
        } else {
          input.type = "password";
          icon.classList.remove("fa-eye-slash");
          icon.classList.add("fa-eye");
        }
      }

      // Check Password Strength
      function checkPasswordStrength(password) {
        const strengthDiv = document.getElementById("password-strength");
        let strength = 0;
        let feedback = [];

        // Length check
        if (password.length >= 8) {
          strength += 1;
        } else {
          feedback.push("At least 8 characters");
        }

        // Uppercase check
        if (/[A-Z]/.test(password)) {
          strength += 1;
        } else {
          feedback.push("One uppercase letter");
        }

        // Lowercase check
        if (/[a-z]/.test(password)) {
          strength += 1;
        } else {
          feedback.push("One lowercase letter");
        }

        // Number check
        if (/[0-9]/.test(password)) {
          strength += 1;
        } else {
          feedback.push("One number");
        }

        // Special character check
        if (/[^A-Za-z0-9]/.test(password)) {
          strength += 1;
        } else {
          feedback.push("One special character");
        }

        // Update strength indicator
        const strengthClasses = [
          "very-weak",
          "weak",
          "medium",
          "strong",
          "very-strong",
        ];
        const strengthTexts = [
          "Very Weak",
          "Weak",
          "Medium",
          "Strong",
          "Very Strong",
        ];

        strengthDiv.className =
          "password-strength " + strengthClasses[strength - 1];
        strengthDiv.innerHTML = `
                <div class="strength-bar">
                    <div class="strength-level" style="width: ${(strength / 5) * 100}%"></div>
                </div>
                <span class="strength-text">${strengthTexts[strength - 1]}</span>
                ${feedback.length > 0 ? `<p class="strength-feedback">Password should contain: ${feedback.join(", ")}</p>` : ""}
            `;

        return strength;
      }

      // Initialize Firebase and Auth
      document.addEventListener("DOMContentLoaded", async () => {
        try {
          await window.initializeFirebase();
          console.log("Firebase initialized successfully");

          // Password strength checker
          const passwordInput = document.getElementById("password");
          if (passwordInput) {
            passwordInput.addEventListener("input", (e) => {
              checkPasswordStrength(e.target.value);
            });
          }

          // Add form submit handler
          const registerForm = document.getElementById("register-form");
          if (registerForm) {
            registerForm.addEventListener("submit", async (event) => {
              event.preventDefault();

              // Get form values
              const firstName = document
                .getElementById("firstName")
                .value.trim();
              const lastName = document.getElementById("lastName").value.trim();
              const email = document.getElementById("email").value.trim();
              const phone = document.getElementById("phone").value.trim();
              const password = document.getElementById("password").value;
              const confirmPassword =
                document.getElementById("confirmPassword").value;
              const terms = document.getElementById("terms").checked;

              // Validate form
              if (
                !firstName ||
                !lastName ||
                !email ||
                !phone ||
                !password ||
                !confirmPassword
              ) {
                showError("Please fill in all required fields");
                return;
              }

              if (!terms) {
                showError(
                  "Please agree to the Terms of Service and Privacy Policy",
                );
                return;
              }

              if (password !== confirmPassword) {
                showError("Passwords do not match");
                return;
              }

              const strength = checkPasswordStrength(password);
              if (strength < 3) {
                showError("Please choose a stronger password");
                return;
              }

              showLoading("Creating your account...");

              try {
                // Create user account
                const userCredential = await firebase
                  .auth()
                  .createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;

                // Update user profile
                await user.updateProfile({
                  displayName: `${firstName} ${lastName}`,
                });

                // Store additional user data in Firestore
                await firebase
                  .firestore()
                  .collection("users")
                  .doc(user.uid)
                  .set({
                    firstName,
                    lastName,
                    email,
                    phone,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    lastLogin: firebase.firestore.FieldValue.serverTimestamp(),
                  });

                showSuccess(
                  "Account created successfully! Redirecting to dashboard...",
                );

                // Store user data in localStorage
                localStorage.setItem(
                  "user",
                  JSON.stringify({
                    uid: user.uid,
                    email: user.email,
                    displayName: user.displayName,
                  }),
                );

                // Redirect to dashboard after a short delay
                setTimeout(() => {
                  window.location.href = "/dashboard.html";
                }, 2000);
              } catch (error) {
                console.error("Registration error:", error);
                let errorMessage = "Failed to create account. ";

                switch (error.code) {
                  case "auth/email-already-in-use":
                    errorMessage += "This email is already registered.";
                    break;
                  case "auth/invalid-email":
                    errorMessage += "Invalid email format.";
                    break;
                  case "auth/weak-password":
                    errorMessage += "Password is too weak.";
                    break;
                  case "auth/operation-not-allowed":
                    errorMessage += "Email/password accounts are not enabled.";
                    break;
                  default:
                    errorMessage += error.message;
                }

                showError(errorMessage);
              } finally {
                hideLoading();
              }
            });
          }
        } catch (error) {
          console.error("Firebase initialization failed:", error);
          const errorContainer = document.getElementById("error-container");
          if (errorContainer) {
            errorContainer.innerHTML =
              '<div class="error-message"><i class="fas fa-exclamation-circle"></i> Failed to initialize the application. Please refresh the page.</div>';
          }
        }
      });

      // Loading state functions
      function showLoading(message = "Loading...") {
        const loadingOverlay = document.getElementById("loading-overlay");
        const loadingText = document.getElementById("loading-message");
        if (loadingOverlay && loadingText) {
          loadingText.textContent = message;
          loadingOverlay.style.display = "flex";
        }
      }

      function hideLoading() {
        const loadingOverlay = document.getElementById("loading-overlay");
        if (loadingOverlay) {
          loadingOverlay.style.display = "none";
        }
      }

      // Message display functions
      function showError(message) {
        const errorContainer = document.getElementById("error-container");
        if (errorContainer) {
          const errorDiv = document.createElement("div");
          errorDiv.className = "error-message";
          errorDiv.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${message}`;
          errorContainer.innerHTML = "";
          errorContainer.appendChild(errorDiv);

          // Auto-hide after 5 seconds
          setTimeout(() => {
            errorDiv.remove();
          }, 5000);
        }
      }

      function showSuccess(message) {
        const errorContainer = document.getElementById("error-container");
        if (errorContainer) {
          const successDiv = document.createElement("div");
          successDiv.className = "success-message";
          successDiv.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
          errorContainer.innerHTML = "";
          errorContainer.appendChild(successDiv);
        }
      }
    </script>
  </body>
</html>
